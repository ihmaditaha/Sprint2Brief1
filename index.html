<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Quiz Demo</title>
    <!-- <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    /> -->
    <style>
      * {
        font-family: Arial, Helvetica, sans-serif;
        box-sizing: border-box;
      }
      body {
        background-color: aqua;
        padding: 3%;
      }
      .quiz-container {
        background-color: aliceblue;
        width: 50vw;
        height: fit-content;
        display: grid;
        justify-self: center;
        justify-items: center;
        padding: 2%;
        border-radius: 15px;
        box-shadow: 0 0 20px navy;
      }
      .quiz-title {
        color: blueviolet;
        font-size: 26px;
        height: fit-content;
      }
      .progress-stats {
        border-bottom: 1px solid pink;
        display: grid;
        grid-template-columns: 2fr 6fr 2fr;
        height: fit-content;
        width: 100%;
        align-items: center;
        text-align: center;
        justify-content: space-between;
        font-size: 2em;
      }
      /* .progress-count {
        font-size: 100%;
      } */
      progress {
        width: 100%;
        position: relative;
        text-align: center;
        height: 50px;
      }
      progress:after {
        position: absolute;
        content: attr(percentage) "%";
        font-size: initial;
        top: 35%;
      }
      .question {
        font-weight: 1000;
        font-size: 1.6em;
        height: 4.8em;
      }
      .choices {
        width: 100%;
      }
      .option {
        width: 100%;
        border-radius: 5px;
        padding: 5%;
        margin: 2% 0;
        cursor: pointer;
      }
      .option:hover {
        background-color: antiquewhite;
      }
      .btn-pr-sui {
        display: flex;
        width: 100%;
        height: fit-content;
        justify-content: space-between;
      }
      .pse-btn {
        border-radius: 5px;
        padding: 5%;
        margin: 2% 0;
        background-color: aquamarine;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div id="quiz" class="quiz-container">
      <div class="quiz-title"><h1>Test Quiz</h1></div>
      <div class="progress-stats">
        <div id="question-num" class="progress-count"></div>
        <progress id="progress-bar" value="" max=""></progress>
        <div id="score" class="progress-score"></div>
      </div>
      <div id="questaff" class="question"></div>
      <div id="optaff" class="choices">
        <button class="option" id="option1"></button>
        <button class="option" id="option2"></button>
        <button class="option" id="option3"></button>
        <button class="option" id="option4"></button>
      </div>
      <div id="navig" class="btn-pr-sui">
        <button id="prev-btn" class="pse-btn">precedant</button>
        <button id="next-btn" class="pse-btn">suivant</button>
        <button id="end-btn" class="pse-btn">terminer</button>
      </div>
    </div>
    <!-- <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script> -->
  </body>
  <script>
    const questarr = [
      {
        question: "Who am I?",
        option: ["Me", "You", "Yu", "Mi"],
        corop: "You",
        info: "explanation",
      },
      {
        question: "Which of these planets is known for its prominent rings?",
        option: ["Mars", "Venus", "Saturn", "Jupiter"],
        corop: "Saturn",
        info: "explanation",
      },
      {
        question: "What is the chemical symbol for gold?",
        option: ["Ag", "Fe", "Pb", "Au"],
        corop: "Au",
        info: "explanation",
      },
      {
        question: "Who painted the Mona Lisa?",
        option: [
          "Vincent van Gogh",
          "Pablo Picasso",
          "Leonardo da Vinci",
          "Claude Monet",
        ],
        corop: "Leonardo da Vinci",
        info: "explanation",
      },
      {
        question: "In which year did the Titanic sink?",
        option: ["1905", "1912", "1923", "1931"],
        corop: "1912",
        info: "explanation",
      },
      {
        question: "Which gas makes up the majority of Earth's atmosphere?",
        option: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Argon"],
        corop: "Nitrogen",
        info: "explanation",
      },
      {
        question: "What is the capital city of Australia?",
        option: ["Sydney", "Melbourne", "Canberra", "Perth"],
        corop: "Canberra",
        info: "explanation",
      },
      {
        question: "What is the hardest natural substance on Earth?",
        option: ["Quartz", "Topaz", "Corundum", "Diamond"],
        corop: "Diamond",
        info: "explanation",
      },
      {
        question:
          "The novel *To Kill a Mockingbird* was written by which author?",
        option: [
          "J.K. Rowling",
          "Harper Lee",
          "Ernest Hemingway",
          "F. Scott Fitzgerald",
        ],
        corop: "Harper Lee",
        info: "explanation",
      },
      {
        question: "How many sides does a heptagon have?",
        option: ["6", "7", "8", "9"],
        corop: "7",
        info: "explanation",
      },
      {
        question:
          "What is the primary function of the red blood cells in the human body?",
        option: [
          "Fighting infection",
          "Clotting blood",
          "Carrying oxygen",
          "Producing antibodies",
        ],
        corop: "Carrying oxygen",
        info: "explanation",
      },
    ];
    const CONTAINER = document.getElementById("quiz");
    const sou2al = document.getElementById("questaff");
    const ikhtiyarat = document.querySelector("#optaff");
    const questionNumber = document.getElementById("question-num");
    const bar = document.getElementById("progress-bar");
    const score = document.getElementById("score");
    const end = document.getElementById("end-btn");
    const suiv = document.getElementById("next-btn");
    const prev = document.getElementById("prev-btn");
    let counter = 0;
    let points = 0;
    let passed = questarr.map(() => false);
    addEventListener("DOMContentLoaded", loading);
    suiv.addEventListener("click", nextFun);
    prev.addEventListener("click", prevFun);
    end.addEventListener("click", calculateScore);

    function loading() {
      questionNumber.innerText = counter + 1;
      bar.max = questarr.length * 10;
      bar.value = (counter + 1) * 10;
      bar.setAttribute("percentage", ((bar.value / bar.max) * 100).toFixed(2));
      score.innerText = points;
      sou2al.innerText = questarr[counter].question;
      ikhtiyarat.innerHTML = ``;
      questarr[counter].option.forEach((opt) => {
        const ikhtiyar = document.createElement("button");
        ikhtiyar.innerHTML = opt;
        ikhtiyar.classList.add("option");
        ikhtiyarat.appendChild(ikhtiyar);
        if (opt == questarr[counter].corop) {
          // ikhtiyarat.innerHTML += `<button class="option" correct="true" id="${opt}">${opt}</button>`;
          ikhtiyar.dataset.correct = true;
        } else {
          // ikhtiyarat.innerHTML += `<button class="option" correct="false" id="${opt}">${opt}</button>`;
          ikhtiyar.dataset.correct = false;
        }
        ikhtiyar.addEventListener("click", selectAnswer);
      });
      buttons();
    }

    function selectAnswer(e) {
      const selected = e.target;
      const isCorrect = selected.dataset.correct === "true";
      if (isCorrect) {
        selected.style.border = "1px solid green";
        selected.style.background = "lightgreen";
        if (!passed[counter]) {
          points += 100;
          passed[counter] = true;
        }
      } else {
        selected.style.border = "1px solid red";
        selected.style.background = "red";
        if (!passed[counter]) {
          passed[counter] = true;
        }
      }
      ikhtiyarat.innerHTML += `<span class="question" style="background: black; color:green ;border-radius: 5px;padding: 1%;height: fit-content;">${questarr[counter].info}</span>`;
      Array.from(ikhtiyarat.children).forEach((btn) => {
        if (btn.dataset.correct === "true") {
          btn.style.border = "1px solid green";
          btn.style.background = "lightgreen";
        }
        btn.disabled = true;
      });
      // passed[counter]=true;
      // let questNum = parseInt(localStorage.getItem("questNum")) || 0;
      // const Data = {
      //   questNum: questNum,
      //   optstat: ikhtiyarat,
      //   answer: selected,
      //   score: points,
      // };
      // localStorage.setItem("questNum", questNum + 1);
      // localStorage.setItem("Data" + Data.questNum, JSON.stringify(Data));
    }

    // function loadsave() {
    //   const questNum = parseInt(localStorage.getItem("questNum")) || 0;
    //   const savedData = JSON.parse(localStorage.getItem("Data" + questNum));
    //   score.innerText = savedData.score;
    //   sou2al.innerText = questarr[counter].question;
    //   ikhtiyarat.innerHTML = ``;
    //   ikhtiyarat.append(savedData.optstat);

    //   buttons();
    // }

    function prevFun() {
      if (counter > 0) {
        counter--;
      } else {
        return;
      }
      // if (!passed[counter]) {
      loading();
      // } else {
      //   loadsave();
      // }
    }

    function calculateScore() {
      CONTAINER.innerHTML = `<div class="quiz-title"><h1>Test Quiz</h1></div>
      <div id="questaff" class="question">Votre score est : ${points} sur ${
        questarr.length * 100
      }</div>`;
      // const btn = document.createElement("button");
      // btn.innerHTML = "Encore";
      // btn.classList.add("pse-btn");
      // CONTAINER.appendChild(btn);
      // btn.addEventListener("click", reset);
    }

    // function reset() {
    //   counter = 0;
    //   points = 0;
    //   loading();
    // }

    function nextFun() {
      if (counter < questarr.length - 1) {
        counter++;
      } else {
        return;
      }
      // if (!passed[counter]) {
      loading();
      // } else {
      //   loadsave();
      // }
    }

    function buttons() {
      if (counter == questarr.length - 1) {
        suiv.style.display = "none";
        end.style.display = "flex";
      }
      if (counter == 0) {
        prev.style.display = "none";
        suiv.style.display = "flex";
        end.style.display = "none";
      }
      if (0 < counter && counter < questarr.length - 1) {
        prev.style.display = "flex";
        suiv.style.display = "flex";
        end.style.display = "none";
      }
    }
  </script>
</html>
